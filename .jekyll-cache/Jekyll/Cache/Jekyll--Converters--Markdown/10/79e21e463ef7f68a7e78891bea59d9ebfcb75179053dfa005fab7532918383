I"x<h2 id="分析某条sql的性能问题通常我们要先看sql的执行计划看看sql的每一步执行是否存在问题常用的两种方法查看sql执行计划">分析某条SQL的性能问题，通常我们要先看SQL的执行计划，看看SQL的每一步执行是否存在问题。常用的两种方法查看SQL执行计划。</h2>
<h4 id="方法一autotrace生成执行计划">方法一：autotrace生成执行计划</h4>

<h4 id="这种方式执行方便但是当遇到执行时间长的sql就变得不太现实它是先产生结果再生成执行计划的关于autotrace几个常用选项的说明">这种方式执行方便，但是当遇到执行时间长的SQL就变得不太现实，它是先产生结果再生成执行计划的。关于Autotrace几个常用选项的说明：</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET  AUTOTRACE  OFF ---------------- 不生成AUTOTRACE 报告，这是缺省模式
SET  AUTOTRACE  ON  EXPLAIN --------- AUTOTRACE只显示优化器执行路径报告
SET  AUTOTRACE  ON  STATISTICS ------ 只显示执行统计信息
SET  AUTOTRACE  ON ----------------- 包含执行计划和统计信息
SET  AUTOTRACE  TRACEONLY -----------同set autotrace on，但是不显示查询输出
</code></pre></div></div>

<h3 id="步骤-1-sqlplus登录数据库">步骤 1 sqlplus登录数据库</h3>
<h3 id="步骤-2-打开autotrace">步骤 2 打开autotrace</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; set autotrace on explain
</code></pre></div></div>
<h3 id="步骤-3-输入要查看的sql">步骤 3 输入要查看的SQL</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; select po.charge, po.new_charge, po.avg_charge
         from lbi_ls_basic.t_l_acct_sum_po_sum_d  po,
             lbi_dim_basic.t_d_dyn_pkgname     pkg,
             lbi_dim_basic.t_d_dyn_tenant_def     def
 where po.subcosid = pkg.productkey(+)
         and po.tenantid = def.tenantid(+); 
返回执行计划结果
</code></pre></div></div>
<h3 id="步骤-4-关闭autotrace">步骤 4 关闭autotrace</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; set autotrace off
----结束
</code></pre></div></div>

<h4 id="方法二explain-plan-for-生成执行计划">方法二、explain plan for 生成执行计划</h4>

<h4 id="这种方式是直接产生执行计划不会产生sql结果">这种方式是直接产生执行计划，不会产生SQL结果。</h4>

<h3 id="步骤1-sqlplus登录数据库">步骤1 sqlplus登录数据库</h3>
<h3 id="步骤2-执行explain-plan-for语句">步骤2 执行explain plan for语句</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; explain plan for 
select po.charge, po.new_charge,po.avg_charge
           from lbi_ls_basic.t_l_acct_sum_po_sum_d   po,
                lbi_dim_basic.t_d_dyn_pkgname       pkg,
                lbi_dim_basic.t_d_dyn_tenant_def     def
       where po.subcosid = pkg.productkey(+) and po.tenantid = def.tenantid(+)
       ;
</code></pre></div></div>
<h3 id="步骤3-查询执行计划">步骤3 查询执行计划</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; select * from table(dbms_xplan.display);
返回结果：略
----结束
</code></pre></div></div>

<h2 id="以上都是不借助图形化的工具借助图形化的工具后方便很多比如plsql-developer强大的不行或者toad也行">以上都是不借助图形化的工具，借助图形化的工具后方便很多，比如:PL/SQL Developer强大的不行，或者Toad也行。</h2>
:ET